schemaVersion: 2.2.0
metadata:
  name: service-one
components:
  - name: dev-tooling
    container:
      image: quay.io/devfile/universal-developer-image:ubi8-latest
  - name: service-two
    container:
      image: quay.io/rh_ee_sshirodk/demo-service-two
  - name: mysql
    container:
      image: registry.redhat.io/rhel8/mysql-80
      memoryRequest: 128M
      memoryLimit: 512M
      sourceMapping: /projects
      mountSources: true
      env:
      - name: MYSQL_USER
        value: mysql80
      - name: MYSQL_PASSWORD
        value: mysql80
      - name: MYSQL_DATABASE
        value: mysql80
      volumeMounts:
      - name: db-volume
        path: /var/lib/mysql/data
      endpoints:
      - name: mysql
        targetPort: 3306
        exposure: internal
  - name: db-volume
    volume:
      size: 2Gi
commands:
  - id: install
    exec:
      commandLine: mvn clean install
      component: dev-tooling
  - id: package
    exec:
      commandLine: mvn package
      component: dev-tooling
  - id: run
    exec:
      commandLine: mvn spring-boot:run
      component: dev-tooling